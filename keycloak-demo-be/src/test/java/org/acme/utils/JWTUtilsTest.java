package org.acme.utils;

import com.fasterxml.jackson.core.JsonProcessingException;
import com.nimbusds.jose.JOSEException;
import org.acme.service.model.User;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;
import java.text.ParseException;

public class JWTUtilsTest {
    private static final String PUBLIC_CERTIFICATE = "MIIClzCCAX8CBgGROwNHDDANBgkqhkiG9w0BAQsFADAPMQ0wCwYDVQQDDARkZW1vMB4XDTI0MDgxMDA2MzczNloXDTM0MDgxMDA2MzkxNlowDzENMAsGA1UEAwwEZGVtbzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANCvjnEvfRYwwupYRIE6ZWdZA+36c+R5+nqztSfLXWqlna13H6NvL4Nzwu3133nimx31dnVdWeuEWWFrV6mWvtPCajGZZvO+nonmHEPQKK6QMJ+XaUNp8VR52xu1VxZ7HD7kN/vaFrA6V4AcUsylH82C5uDSVa/QRttfIklXXHWfiBlycxsSx8ldHVKT14TKuw2bbdFoflLv7S/3IvTY1IoR78ufDC9stz2/dhzDGbM6DEA43vgPifqOpJVafV3Olo5NYu2Fwr/tW1NDWmqF1dK5QFboVdgeOZD2DjOi/QtCSdwsOKcfsS0snX7i5VSfn7AmX/kFGJgDIpWmFZUVK5cCAwEAATANBgkqhkiG9w0BAQsFAAOCAQEAX0rOizkoTiUtiXWarpy36CAAbZdBTi9iyjUu28XHJoaAbzuQWLJ0PbDYYoy20OM+YHUlwnLfx+hZ1Jdf3eJn55kulJ1kVY1Bj/6/j6PTvAwR2zvsWxuntLNfIJ2S0FFkORA1uhYMn6EIckL7L1qB4cAiNbfZmUKTbWtbmxPZNtzw6FMKnTKnP1IXiomFJTTvgZ4r9cMB5eRVT0H2rFCGzClDacNqlWRv0EIyQcOo2F5cethBGCB+DCTMg1BO8Ru/MseHP2WoZ71OpLy62Y4BLuWHDor9dzUJR/I6yz/2PaFX5+XoldZzjqhIfmJTCPlqr4H5txfsxoq6K7D1M8p8og==";

    @Test
    public void testVerifyToken() throws Exception{
        String idToken = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJtRzJWdEtSRzhxMDBLakNVckZLNlJ6cXJHVWg3YkgtU3hBaWVlbnBNdjVBIn0.eyJleHAiOjE3MjMzNDY1MzIsImlhdCI6MTcyMzM0NjIzMiwiYXV0aF90aW1lIjoxNzIzMzQ2MjMyLCJqdGkiOiI2YWQ1OWZhOS01M2JkLTQ4MjgtYmRlMi0xNTMxNzdjNjA0NWMiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL2RlbW8iLCJhdWQiOiJuZXh0anMtZGVtbyIsInN1YiI6ImZlMWQ1NDQ5LTQyYmMtNDZmMy1hMTljLWJlYjE1YWIwM2JhNyIsInR5cCI6IklEIiwiYXpwIjoibmV4dGpzLWRlbW8iLCJzaWQiOiI0NTFjMWQ1NS03NjJlLTRiM2QtODRiYi02NDk4NGQzNjk2YWMiLCJhdF9oYXNoIjoiMGZxOFF3c2hyN0dxMzVUTHloYlkzQSIsImFjciI6IjEiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkNvc3RhbnpvIFN1biIsInByZWZlcnJlZF91c2VybmFtZSI6ImNvc3RhbnpvIiwiZ2l2ZW5fbmFtZSI6IkNvc3RhbnpvIiwiZmFtaWx5X25hbWUiOiJTdW4iLCJlbWFpbCI6ImNvc3RhbnpvQGFiYy5jb20ifQ.vPVMBuy1GpuRXbct5T-8YhSdhiL4Hd7-JgR6lXA3apb_IQi9KP-XKLwjsUUYY4eKMNnGxQE8cj8gs44tzKdVVD23WjNyXWPApGGX_NBagVe9N3tBaNtK_Hjk4PfsnBJleckM-hVRduS0tVw8hy468h7anzzstxx4ZXh__JFmTmLC5WRHSaZSCnGt6vt1N2i7OXI1ijjrpFJ3FCKLd2DdPBbsuR8mTwAceXH9tveET9JsNwDyawyAnnQe7ikeSH-4YIDcIwhQK3aUDHlk4hYnr0pvlVUUjPqcy9d12SV1iyC9wK4FLUHBe9dUNj8SaYsDUv3CLUvho4gGqbPgGdC4DA";
        String accessToken = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJtRzJWdEtSRzhxMDBLakNVckZLNlJ6cXJHVWg3YkgtU3hBaWVlbnBNdjVBIn0.eyJleHAiOjE3MjMzNDY1MzIsImlhdCI6MTcyMzM0NjIzMiwiYXV0aF90aW1lIjoxNzIzMzQ2MjMyLCJqdGkiOiJiMDgyZTM2Zi1hMjQwLTQ2NDctOWY3MC0yODg0MjFiYzg0NzIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvcmVhbG1zL2RlbW8iLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiZmUxZDU0NDktNDJiYy00NmYzLWExOWMtYmViMTVhYjAzYmE3IiwidHlwIjoiQmVhcmVyIiwiYXpwIjoibmV4dGpzLWRlbW8iLCJzaWQiOiI0NTFjMWQ1NS03NjJlLTRiM2QtODRiYi02NDk4NGQzNjk2YWMiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMCJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsImRlZmF1bHQtcm9sZXMtZGVtbyJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6IkNvc3RhbnpvIFN1biIsInByZWZlcnJlZF91c2VybmFtZSI6ImNvc3RhbnpvIiwiZ2l2ZW5fbmFtZSI6IkNvc3RhbnpvIiwiZmFtaWx5X25hbWUiOiJTdW4iLCJlbWFpbCI6ImNvc3RhbnpvQGFiYy5jb20ifQ.sqCax3v3O9geW2a3aG87oZ0XWkdnqXbsA3AFlalW1AmyCR3i3u3HThxLoNiGp4X-3eOQ2ueXMHdnoeLB765GrHxgD5NXBF0BGiXjC-WAhORJ9ru2PLfg-9D-V_b4PeH-gFIaidg7SjyqLI4ZQL9fFeqafIx5Lz6YZCJocNziRMcK_FCJEMooACVFNiJoXxQtn40Pss7Ua35ERcXbdvyR2LbX-uSuBBZl8ChlmjjUVnfL-qDOwlBUpfbUqHpUPCVDc9mXERWliAqGqVIYvSnk032EJ_JTJDq0KbN8Jxyd1Z7XiCNR4zr55ctcQPTFfPjuQNLRoQlgRElrfQ6Fp4X5fQ";
        User user = JWTUtils.parseIdToken(idToken);
        Assertions.assertNotNull(user);
    }
}
